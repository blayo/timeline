<html>
  <head>
    <title>Milebook</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <script src="https://dev.mavo.io/dist/mavo.js"></script>
    <link rel="stylesheet" href="https://dev.mavo.io/dist/mavo.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css"/>
    <script type="text/javascript">
Mavo.Plugins.register('linearRegression', {
  extend: {
    Functions: {
      linearRegression: function (x, y, targetX) {
        // from: https://github.com/simple-statistics/simple-statistics/blob/master/src/linear_regression.js
        function linearRegression(data) {
            var m, b;
            var dataLength = data.length;
            if (dataLength === 1) {
                m = 0;
                b = data[0][1];
            } else {
                var sumX = 0, sumY = 0,
                    sumXX = 0, sumXY = 0;
                var point, x, y;
                for (var i = 0; i < dataLength; i++) {
                    point = data[i];
                    x = point[0];
                    y = point[1];
                    sumX += x;
                    sumY += y;
                    sumXX += x * x;
                    sumXY += x * y;
                }
                m = ((dataLength * sumXY) - (sumX * sumY)) /
                    ((dataLength * sumXX) - (sumX * sumX));
                b = (sumY / dataLength) - ((m * sumX) / dataLength);
            }
            return {
                m: m,
                b: b
            };
        }
        if (x.length !== y.length) {
          throw new Exception('x, y array should have same length');
        }
        const data = [];
        for(let i=0;i<x.length;i++) {
          data.push([new Date(x[i]).getTime(), parseInt(y[i])]);
        }
        const { m, b } = linearRegression(data);
        return Math.round(new Date(targetX).getTime() * m + b);
      }
    }
  }
});
    </script>
  </head>
  <body>
    <div class="container" mv-app="milebook" mv-mode="edit" mv-storage="https://github.com/blayo/timeline">
      <article property="day" mv-multiple>
        <div class="card">
          <div class="card-block">
            <h6 class="card-header" property="name">Day</h6>
            <div>
              Enter time and activity:
              <table class="table table-hover">
                <thead>
                  <tr>
                    <th>Time</th>
                    <th>Activity</th>
                    <th>Type</th>
                  </tr>
                </thead>
                <tbody>
                  <tr property="row" mv-multiple>
                    <td><time property="time"></time></td>
                    <td><span property="activity"></span></td>
                    <td><span property="type"></span></td>
                  </tr>
                </tbody>
              </table>
            </div>
        </div>
      </article>
    </div>
  </body>
</html>
